#include <stdio.h>
#include <math.h>
#include <stdlib.h>

float determinant(float [][25], float);
void cofactor(float [][25], float);
void transpose(float [][25], float [][25], float);

float input[25][25] = {
 {-0.45913321,-0.44557664,-0.28172694, 0.02201891,-0.74237228,-0.0618261 , 0.31763746, 0.58717635,-0.67245916,-0.92838646},
 {-0.00475745, 1.42971812,-0.87222351,-0.03519994, 0.14704458, 1.01731569,-0.71869154,-0.59623072,-0.18409979, 1.85127114},
 { 1.41133931,-0.36356772,-0.31309242,-0.7839417 ,-0.16850844,-0.28335386,-0.86568385,-1.13663404, 0.06799488,-1.38241444},
 { 0.82929923, 0.77352696, 0.42023935, 0.68431904,-1.50966969, 0.56230258,-0.47478228,-0.67935649, 0.13135201, 0.00267759},
 {-1.60299525, 0.00866186, 0.75879834, 0.40985187,-0.77042848,-0.21746584, 0.77895414, 0.32497978,-1.47350852, 0.0227486 },
 {-0.97788733,-1.04607191,-0.00476806, 0.88214966,-0.62653096, 1.98854604, 0.61769651,-1.77923414, 0.70198803, 0.23673855},
 {-0.11225063,-0.57554205,-1.11705264, 0.78635361, 1.00111173,-0.34876602, 1.04826018,-0.76360772,-0.33544738,-1.49934562},
 {-0.12374809, 1.81387795, 1.06877933, 1.193205  , 2.37803558, 0.53105511,-1.63835788,-1.908582  ,-0.50193768, 0.24957352},
 { 0.12227794, 0.15706598, 1.85885713, 0.60865907, 2.01825802, 2.13973581,-1.70548418,-1.05820444, 1.45719   , 0.0992072 },
 { 1.81192603,-0.12355896,-0.95307709,-0.30358278,-1.4984563 ,-1.28231023,-0.44269714, 0.37801417,-0.46693957, 0.60218681}
};
float output[25][25] = {
 {-1.09846130e+00, 5.90628879e-01, 3.50669394e-01, 4.13622449e-01, 1.11417112e+00,-6.71375447e-01, 1.05143627e+00,-9.61260639e-01, 9.93139837e-01, 3.68476487e-01},
 {-1.72979808e-01, 1.65174591e-01, 1.88422168e-02, 4.76737230e-01,-1.35127840e-01,-2.93834441e-01, 1.35911630e-02, 1.14681527e-03,-2.65980397e-01,-5.35529994e-01},
 {-8.33845050e-01,-2.43765131e-03, 2.25591194e-01, 2.29083560e-01, 7.88270508e-01,-3.00405637e-01, 2.33923082e-01,-3.96480672e-01, 4.43097776e-01, 8.95250954e-04},
 { 6.44082141e-01,-4.04037396e-01,-6.56557383e-01, 9.27061316e-02,-5.33072830e-01, 2.79640062e-01,-4.24288182e-02, 4.91335388e-01,-1.33544144e-01, 3.50374870e-01},
 {-4.05432324e-01, 2.39266937e-01, 7.34058206e-02,-1.56288918e-01, 3.71179491e-01,-2.78768271e-01, 4.53908805e-01,-2.55269657e-01, 4.03578919e-01, 7.36284113e-02},
 {-3.37130066e-01, 7.93817480e-01, 3.08675424e-01, 2.84988961e-01, 8.95751073e-01,-4.56692556e-01, 7.69381631e-01,-8.69586442e-01, 9.13877438e-01, 1.83781039e-02},
 {-1.53985744e+00, 5.40968088e-01, 3.16379922e-01, 4.85297791e-01, 1.18138703e+00,-6.02812904e-01, 1.04740471e+00,-1.03452329e+00, 6.09917013e-01,-1.84420172e-01},
 { 3.81973673e-01, 1.16123272e-01,-2.84368776e-01, 5.44497525e-02,-8.94231195e-03,-3.02235058e-01, 1.42336892e-01,-2.28314898e-01, 3.20188101e-01, 9.42646409e-02},
 { 4.68566679e-01,-6.83866844e-01,-4.28872807e-01, 1.78151906e-03,-1.33342032e+00, 4.80770176e-01,-8.00636926e-01, 6.41340625e-01,-8.41685391e-01,-4.19016242e-01},
 {-4.60565614e-01, 1.29472302e-01,-1.06713220e-01,-1.95501913e-01, 2.69909949e-01, 7.85363278e-02, 1.56060049e-02,-9.40534424e-02, 1.36138613e-01, 3.22763332e-01}
};
 
int main()
{
    float a[25][25], k = 10;
    cofactor(input, k);
    return 0;
}

float determinant(float a[25][25], float k)
{
    float s = 1, det = 0, b[25][25];
    int i, j, m, n, c;
    if (k == 1)
        return a[0][0];
    
    det = 0;
    for (c = 0; c < k; c++)
    {
        m = 0;
        n = 0;
        for (i = 0;i < k; i++)
        for (j = 0 ;j < k; j++) {
            b[i][j] = 0;
            if (i != 0 && j != c)
            {
                b[m][n] = a[i][j];
                if (n < (k - 2))
                    n++;
                else
                    n = 0, m++;
            }
        }
        det = det + s * (a[0][c] * determinant(b, k - 1));
        s = -1 * s;
    }
    return det;
}

void cofactor(float num[25][25], float f)
{
    float b[25][25], fac[25][25];
    int p, q, m, n, i, j;
    for (q = 0;q < f; q++)
    for (p = 0;p < f; p++)
    {
        m = 0;
        n = 0;
        for (i = 0;i < f; i++)
        for (j = 0;j < f; j++)
            if (i != q && j != p)
            {
                b[m][n] = num[i][j];
                if (n < (f - 2))
                    n++;
                else
                    n = 0, m++;
            }
        fac[q][p] = pow(-1, q + p) * determinant(b, f - 1);
    }
    transpose(num, fac, f);
}

void transpose(float num[25][25], float fac[25][25], float r)
{
    int i, j;
    float b[25][25], inverse[25][25], d;

    for (i = 0;i < r; i++)
    for (j = 0;j < r; j++)
        b[i][j] = fac[j][i];
    
    d = determinant(num, r);
    
    for (i = 0;i < r; i++)
    for (j = 0;j < r; j++)
        inverse[i][j] = b[i][j] / d;
    
    for (i = 0;i < r; i++)
    for (j = 0;j < r; j++)
        if (abs(inverse[i][j] - output[i][j]) > .1f)
            exit(1);
} 
